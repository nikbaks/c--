#include <iostream>
using namespace std;

void AddColumn(int**& arr, int M, int& N, int pos, int value = 0) {
    int** newArr = new int*[M];
    for (int i = 0; i < M; i++)
        newArr[i] = new int[N + 1];

    for (int i = 0; i < M; i++) {
        for (int j = 0; j < pos; j++)
            newArr[i][j] = arr[i][j];
        newArr[i][pos] = value;
        for (int j = pos; j < N; j++)
            newArr[i][j + 1] = arr[i][j];
    }

    for (int i = 0; i < M; i++)
        delete[] arr[i];
    delete[] arr;

    arr = newArr;
    N++;
}

void DeleteColumn(int**& arr, int M, int& N, int pos) {
    int** newArr = new int*[M];
    for (int i = 0; i < M; i++)
        newArr[i] = new int[N - 1];

    for (int i = 0; i < M; i++) {
        for (int j = 0; j < pos; j++)
            newArr[i][j] = arr[i][j];
        for (int j = pos + 1; j < N; j++)
            newArr[i][j - 1] = arr[i][j];
    }

    for (int i = 0; i < M; i++)
        delete[] arr[i];
    delete[] arr;

    arr = newArr;
    N--;
}

void ShiftRows(int** arr, int M, int N, int k, bool down) {
    k %= M;
    while (k--) {
        if (down) {
            int* t = arr[M - 1];
            for (int i = M - 1; i > 0; i--)
                arr[i] = arr[i - 1];
            arr[0] = t;
        } else {
            int* t = arr[0];
            for (int i = 0; i < M - 1; i++)
                arr[i] = arr[i + 1];
            arr[M - 1] = t;
        }
    }
}

void ShiftColumns(int** arr, int M, int N, int k, bool right) {
    k %= N;
    while (k--) {
        if (right) {
            for (int i = 0; i < M; i++) {
                int t = arr[i][N - 1];
                for (int j = N - 1; j > 0; j--)
                    arr[i][j] = arr[i][j - 1];
                arr[i][0] = t;
            }
        } else {
            for (int i = 0; i < M; i++) {
                int t = arr[i][0];
                for (int j = 0; j < N - 1; j++)
                    arr[i][j] = arr[i][j + 1];
                arr[i][N - 1] = t;
            }
        }
    }
}

int main() {
    int M = 3, N = 4;
    int** arr = new int*[M];
    for (int i = 0; i < M; i++)
        arr[i] = new int[N];

    int c = 1;
    for (int i = 0; i < M; i++)
        for (int j = 0; j < N; j++)
            arr[i][j] = c++;

    AddColumn(arr, M, N, 1, 99);
    DeleteColumn(arr, M, N, 2);
    ShiftRows(arr, M, N, 1, true);
    ShiftColumns(arr, M, N, 1, true);

    for (int i = 0; i < M; i++) {
        for (int j = 0; j < N; j++)
            cout << arr[i][j] << " ";
        cout << endl;
    }

    for (int i = 0; i < M; i++)
        delete[] arr[i];
    delete[] arr;

    return 0;
}
